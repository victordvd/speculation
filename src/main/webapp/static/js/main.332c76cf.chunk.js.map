{"version":3,"sources":["util.tsx","Global.ts","position_store.ts","canvas.ts","model.ts","component/ContractGrid.tsx","component/ContractWeekCombo.tsx","component/Popup.tsx","component/HomePage.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["Utils","o","$","model","console","log","existing","PostionStore","getData","filter","i","contract","ls","cp","strike","length","addAmount","amount","addRow","push","plotPosition","LS","LONG","SHORT","type","CP","CALL","PUT","price","PositionModel","getTXOInstance","Contract","TXO","undefined","ask","bid","p","m","parsePosition","colStyle","border","padding","style","width","onClick","addPosition","posiFn","GlobalVar","txoData","profit","settle","this","data","positions","forEach","contractWeek","json","JSON","stringify","navigator","clipboard","writeText","then","err","error","getPositionTable","find","remove","delRecIdx","rec","equals","splice","fplot","document","querySelector","fnEtStk","getAnalyzeFn","firstChild","removeChild","fpVO","target","tip","xLine","yLine","grid","yAxis","label","xAxis","domain","spot","annotations","val","x","text","functionPlot","strikes","Set","posiFnVO","pos","m1","b1","m2","b2","add","addPosiFunc","Array","from","Infinity","sort","a","b","fnSet","item","defautFnVO","posi","fn","defaultCost","plotVO","red","range","skipTip","Number","color","Coordinate","y","CanvasBuilder","canvas","getElementById","ctx","getContext","y_base","height","draw","addEventListener","e","rect","getBoundingClientRect","pageX","left","toFixed","pageY","top","mousePointX","min_settle","settlePerPx","totalProfit","mod","getProfit","beginPath","strokeStyle","lineWidth","moveTo","lineTo","stroke","fillStyle","font","floatText","toString","floatText2","profitPerPx","measureText","textAlign","fillText","clear","settle_range","profit_range","settle_origin","x_0","convertSettleToX","max_settle","drawPosition","fillRect","getInflections","coor","idx","convertProfitToY","isInit","enabled","row","td_act","td_cp","td_con","td_strike","td_amount","td_price","amountField","children","prop","click","addClass","siblings","removeClass","setDelBtn","setContract","setActionCbx","setCPCbx","setStrikePrice","setAmount","setPrice","append","td","btn","icon","css","removePosition","lsCbx","long","createElement","short","change","valChange","selected","conCbx","txo","tx","TX","c","input","attr","overTick","maxX","maxY","minX","minY","re","fMin","getSettle","fStrike","fMax","act","init","ContractGrid","props","state","items","setState","React","Children","map","child","Component","ContractWeekCombo","weekCode","value","event","onChangeImpl","onChange","handleChange","apply","Popup","handleOpenModal","isOpen","handleCloseModal","loadJson","parse","element","parsePositionForRaw","bind","defaultValue","HomePage","contractSelector","createRef","contractWeekCombo","jsonPopup","current","callContracts","putContracts","s","lcBtn","createPosiBtn","scBtn","lpBtn","spBtn","rowStyle","Math","abs","home","get","window","location","href","match","targetContractCode","contractCodes","code","addContractCode","setContractCode","addContractRows","loadTxoData","m_2","removeAllPosition","getDataJson","alert","ref","id","min","display","overflow","v","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.332c76cf.chunk.js","sourcesContent":["import $ from 'jquery';\r\nimport React from 'react';\r\nimport { PostionStore } from './position_store'\r\nimport { PositionModel, Contract, CP, LS } from './model'\r\nimport Button from './component/Button'\r\nimport GlobalVar from './Global';\r\nimport { Col } from 'react-grid-system';\r\n\r\nexport class Utils {\r\n  static posiFn: any = {}\r\n\r\n  static checkNull(o: any) {\r\n    if (o == null)\r\n      return '-'\r\n\r\n    return o\r\n  }\r\n\r\n  static getPositionTable() {\r\n    return $('#positionTable')\r\n  }\r\n\r\n  static addPosition(model: PositionModel) {\r\n\r\n    console.log('addposi' + model)\r\n    let existing = PostionStore.getData().filter(i => i.contract == model.contract && i.ls == model.ls && i.cp == model.cp && i.strike == model.strike)\r\n\r\n    if (existing.length > 0) {\r\n      existing[0].addAmount(model.amount)\r\n    } else {\r\n      model.addRow()\r\n      PostionStore.getData().push(model)\r\n      PostionStore.plotPosition()\r\n    }\r\n  }\r\n\r\n  /* [{\"ls\":\"L\",\"contract\":{\"type\":\"C\",\"strike\":18200,\"bid\":47.5,\"ask\":48},\"price\":48},\r\n  {\"ls\":\"S\",\"contract\":{\"type\":\"C\",\"strike\":18300,\"bid\":33.5,\"ask\":35.5},\"price\":33.5}] \r\n  \r\n  {\"contract\":\"TXO\",\"ls\":\"Long\",\"cp\":\"Call\",\"strike\":14200,\"amount\":1,\"price\":3060},\r\n  */\r\n  static parsePositionForRaw(o: any) {\r\n    let ls = (o.ls == 'Long') ? LS.LONG : LS.SHORT\r\n    // let contract = o.contract\r\n    let type = (o.cp == 'Call') ? CP.CALL : CP.PUT\r\n    let strike = o.strike\r\n    let price = o.price\r\n    let amount = o.amount\r\n\r\n    return PositionModel.getTXOInstance(ls, type, Contract.TXO, strike, amount, price)\r\n  }\r\n  // static parsePositionForRaw(o: any) {\r\n  //   let ls = (o.ls == 'L') ? LS.LONG : LS.SHORT\r\n  //   let contract = o.contract\r\n  //   let type = (contract.type == 'C') ? CP.CALL : CP.PUT\r\n  //   let strike = contract.strike\r\n  //   let price = o.price\r\n\r\n  //   return PositionModel.getTXOInstance(ls, type, Contract.TXO, strike, 1, price)\r\n  // }\r\n\r\n  static parsePosition(o: any, ls: LS) {\r\n    let type = (o.type == 'C') ? CP.CALL : CP.PUT\r\n    let strike = o.strike\r\n    let price = undefined\r\n\r\n    if (LS.LONG === ls)\r\n      price = o.ask\r\n    else if (LS.SHORT === ls)\r\n      price = o.bid\r\n\r\n    return PositionModel.getTXOInstance(ls, type, Contract.TXO, strike, 1, price)\r\n  }\r\n\r\n  static createPosiBtn(p: any, ls: LS) {\r\n    let m = Utils.parsePosition(p, ls)\r\n    const colStyle= {border: '1px solid black',\r\n    padding: '3px'}\r\n\r\n    if (m.price == undefined)\r\n      return <Col style={colStyle}></Col>\r\n\r\n    // let fnName = ls + p.type + p.strike + '_posifn'\r\n    // Utils.posiFn[fnName] = () => {\r\n    //   m = Utils.parsePosition(p, ls)\r\n    //   Utils.addPosition(m)\r\n    // }\r\n    // return '<button type=\"button\" style=\"width:100%;\" onclick=\"Utils.posiFn.' + fnName + '()\">' + m.price + '</button> '\r\n\r\n    const style= {\r\n      width:'100%'\r\n    }\r\n\r\n    return <Col style={colStyle}><button style={style} onClick={() => {\r\n      m = Utils.parsePosition(p, ls)\r\n      Utils.addPosition(m)\r\n    }}>    {m.price}</button></Col>\r\n  }\r\n\r\n\r\n\r\n\r\n}","export default class GlobalVar{\r\n    public static txoData:any = {};\r\n\r\n} \r\n\r\n","import $ from 'jquery';\r\nimport { PositionModel, Contract, CP, LS } from './model'\r\nimport { Utils } from './util'\r\nimport GlobalVar from './Global'\r\nimport functionPlot from \"function-plot\";\r\n\r\nexport class PoistionCoefficient {\r\n\r\n    y: number = 0//profit\r\n    x: number = 0//settle price\r\n\r\n    ls: number\r\n    cp: number\r\n    strike: number\r\n    price: number\r\n    amount: number\r\n\r\n}\r\n\r\nexport class PostionStore {\r\n\r\n    //plot function Coefficients\r\n    profit: number//y\r\n    settle: number//x\r\n    strike: number\r\n    cp: number//C:+1  P:-1\r\n    ls: number//L:-  S:+\r\n    price: number\r\n\r\n    // static strikes:Array<number>\r\n    // static m:number\r\n    // static b:number\r\n\r\n    private static data: Array<PositionModel> = []\r\n\r\n    static getData() {\r\n        return this.data\r\n    }\r\n\r\n    static getDataJson() {\r\n        let positions: any = []\r\n\r\n        this.data.forEach((p: PositionModel) => {\r\n            positions.push({ contract: p.contract, contractWeek: p.contractWeek, ls: p.ls, cp: p.cp, strike: p.strike, amount: p.amount, price: p.price })\r\n        })\r\n\r\n        let json = JSON.stringify(positions)\r\n\r\n        navigator.clipboard.writeText(json).then(function() {\r\n            console.log('Async: Copying to clipboard was successful!');\r\n          }, function(err) {\r\n            console.error('Async: Could not copy text: ', err);\r\n          });\r\n\r\n        return json\r\n    }\r\n\r\n    static addPosition(p: PositionModel) {\r\n        this.data.push(p)\r\n    }\r\n\r\n    static removeAllPosition() {\r\n        this.data = []\r\n\r\n        Utils.getPositionTable().find(\"tr:gt(0)\").remove()\r\n        PostionStore.plotPosition()\r\n    }\r\n\r\n    static removePosition(p: PositionModel) {\r\n\r\n        let delRecIdx: number = undefined\r\n\r\n        this.data.forEach((rec, i) => {\r\n\r\n            if (rec.equals(p))\r\n                delRecIdx = i\r\n        });\r\n\r\n        if (delRecIdx !== undefined)\r\n            this.data.splice(delRecIdx, 1)\r\n\r\n        console.log('removed rec: ' + delRecIdx)\r\n    }\r\n\r\n    static plotPosition() {\r\n\r\n        const fplot = document.querySelector(\"#fplot\")\r\n\r\n        let fnEtStk = this.getAnalyzeFn()\r\n        // console.log(data)\r\n\r\n        //reset\r\n        while (fplot.firstChild) {\r\n            fplot.removeChild(fplot.firstChild);\r\n        }\r\n\r\n        let fpVO: any = {\r\n            target: fplot,\r\n            tip: {\r\n                xLine: true,    // dashed line parallel to y = 0\r\n                yLine: true    // dashed line parallel to x = 0\r\n                //   renderer: (x:number, y:number, index:number) =>{\r\n                //     return x+' : '+y\r\n                //   }\r\n            },\r\n            grid: true,\r\n            yAxis: { label: 'Profit (tick)' },\r\n            xAxis: { domain: [GlobalVar.txoData.spot - 500, GlobalVar.txoData.spot + 500], label: 'Settle Price' },\r\n            data: fnEtStk.data,\r\n            annotations: fnEtStk.annotations\r\n            // data: [\r\n            //   {fn: 'x^2'},\r\n            //   {fn: '3x'}\r\n            // ]\r\n        }\r\n\r\n        let spot = $('#spot').val()\r\n\r\n        if (spot)\r\n            fpVO.annotations.push({ x: spot, text: 'spot: ' + spot })\r\n\r\n\r\n        console.log(fpVO)\r\n\r\n        functionPlot(fpVO)\r\n    }\r\n\r\n    static getAnalyzeFn() {\r\n\r\n        let strikes: Set<number> = new Set\r\n\r\n        //[{strike,[m1,b1],[m2,b2]}]\r\n        let posiFnVO: Array<any> = []\r\n\r\n        this.data.forEach((pos) => {\r\n\r\n            let hRange: Array<any> = [0, pos.strike]\r\n            let sRange: Array<any> = [pos.strike, Infinity]\r\n\r\n            //multi\r\n            let m1: number\r\n            let b1: number\r\n\r\n            let m2: number\r\n            let b2: number\r\n\r\n            let ls\r\n            let cp\r\n\r\n            if (pos.contract === Contract.TXO) {\r\n                if (pos.ls === LS.LONG)\r\n                    ls = -1\r\n                else\r\n                    ls = 1\r\n\r\n                if (pos.cp === CP.CALL)\r\n                    cp = 1\r\n                else\r\n                    cp = -1\r\n\r\n                if (cp === 1) {\r\n\r\n                    m1 = 0\r\n                    b1 = (ls * pos.price) * pos.amount\r\n                    m2 = -ls * cp * pos.amount\r\n                    b2 = (ls * (pos.price) + ls * cp * pos.strike) * pos.amount\r\n                } else {\r\n\r\n                    m1 = -ls * cp * pos.amount\r\n                    b1 = (ls * (pos.price) + ls * cp * pos.strike) * pos.amount\r\n                    m2 = 0\r\n                    b2 = (ls * pos.price) * pos.amount\r\n                }\r\n\r\n                strikes.add(pos.strike)\r\n                posiFnVO.push([pos.contract, pos.strike, [m1, b1], [m2, b2]])\r\n            } else {\r\n\r\n                if (pos.ls === LS.LONG) {\r\n\r\n                    m1 = 1 * pos.amount\r\n                } else {\r\n\r\n                    m1 = -1 * pos.amount\r\n                }\r\n\r\n                b1 = -pos.price * pos.amount\r\n\r\n                posiFnVO.push([pos.contract, [m1, b1]])\r\n            }\r\n\r\n\r\n\r\n        })\r\n\r\n        return this.addPosiFunc(Array.from(strikes), posiFnVO)\r\n    }\r\n\r\n    static addPosiFunc(strikes: Array<number>, posiFnVO: Array<Array<any>>) {\r\n\r\n        strikes.push(Infinity)\r\n        strikes.sort((a, b) => { return a - b })\r\n\r\n        //[[[range],m,b]]\r\n        let fnSet: Array<Array<any>> = []\r\n        let annotations: Array<object> = []\r\n\r\n        strikes.forEach((item, i) => {\r\n\r\n            //[[range],m,b]\r\n            let defautFnVO = [[strikes[i], strikes[i + 1]], 0, 0]\r\n\r\n            if (i === 0) {\r\n                fnSet.push([[0, strikes[0]], 0, 0])\r\n                fnSet.push(defautFnVO)\r\n            } else if (i === strikes.length - 1) { }\r\n\r\n            else\r\n                fnSet.push(defautFnVO)\r\n\r\n\r\n            if (item !== Infinity)\r\n                annotations.push({ x: item, text: item })\r\n        })\r\n\r\n        // posiFnVO.sort((a,b)=>{return a[0]-b[0]})\r\n\r\n        if (fnSet.length === 0 && posiFnVO.length !== 0) {\r\n            fnSet.push([[0, Infinity], 0, 0])\r\n        }\r\n\r\n        posiFnVO.forEach(posi => {\r\n\r\n            let contract = posi[0]\r\n            let strike = posi[1]\r\n\r\n            fnSet.forEach(fn => {\r\n                if (contract === Contract.TXO) {\r\n                    if (fn[0][1] <= strike) {\r\n\r\n                        //m\r\n                        fn[1] += posi[2][0]\r\n                        //b\r\n                        fn[2] += posi[2][1]\r\n\r\n                    } else {\r\n\r\n                        //m\r\n                        fn[1] += posi[3][0]\r\n                        //b\r\n                        fn[2] += posi[3][1]\r\n                    }\r\n                } else {\r\n                    //m\r\n                    fn[1] += posi[1][0]\r\n                    //b\r\n                    fn[2] += posi[1][1]\r\n                }\r\n            })\r\n\r\n\r\n        })\r\n\r\n\r\n        console.log('fnSet'+fnSet)\r\n\r\n        let defaultCost = $('#defaultCost').val()\r\n\r\n        //range ,fn\r\n        let plotVO: Array<object> = []\r\n        let red = 'rgb(255, 0, 0)'\r\n        let blue = 'rgb(0, 0, 255)'\r\n\r\n\r\n        plotVO.push({ range: [0, Infinity], fn: '0', skipTip: true })\r\n\r\n        fnSet.forEach((item, i) => {\r\n            let fn = item[1] + '*x+' + item[2]\r\n            if (defaultCost > 0)\r\n                fn += '-' + Number(defaultCost) * fnSet.length\r\n            console.log(fn)\r\n            let color = red\r\n\r\n            if (i % 2 === 0)\r\n                color = red\r\n            else\r\n                color = blue\r\n\r\n            plotVO.push({ range: item[0], fn: fn, color: color/*,closed: true*/ })\r\n        })\r\n\r\n        // plotVO.push({  fn: fnSet.length*-defaultCost+\"\"/*,closed: true*/ })\r\n\r\n\r\n        return { annotations: annotations, data: plotVO }\r\n    }\r\n\r\n}","import {Contract, PositionModel} from './model'\r\nimport {PostionStore} from './position_store'\r\n\r\nexport class Coordinate {\r\n    x: number\r\n    y: number\r\n\r\n    constructor(x: number, y: number) {\r\n        this.x = x\r\n        this.y = y\r\n    }\r\n}\r\n\r\nexport class CanvasBuilder {\r\n\r\n    static isInit = false\r\n\r\n    static settle_range: number = 600\r\n    static settlePerPx: number\r\n    static max_settle: number\r\n    static min_settle: number\r\n\r\n    static profit_range: number = 300\r\n    static profitPerPx: number\r\n\r\n    static canvas: HTMLCanvasElement\r\n    static ctx: CanvasRenderingContext2D\r\n\r\n    static y_base: number\r\n\r\n    static init() {\r\n\r\n        CanvasBuilder.canvas = <HTMLCanvasElement>document.getElementById(\"canv\")\r\n        CanvasBuilder.ctx = CanvasBuilder.canvas.getContext(\"2d\")\r\n        CanvasBuilder.y_base = CanvasBuilder.canvas.height / 2\r\n\r\n        CanvasBuilder.draw()\r\n\r\n        CanvasBuilder.canvas.addEventListener('mousemove', (e) => {\r\n\r\n            CanvasBuilder.draw()\r\n\r\n            let rect = CanvasBuilder.canvas.getBoundingClientRect()\r\n\r\n            let x = e.pageX - Number(rect.left.toFixed(0))\r\n            let y = e.pageY - Number(rect.top.toFixed(0))\r\n\r\n            // console.log(x+' : '+y)\r\n            let mousePointX = CanvasBuilder.min_settle + x * CanvasBuilder.settlePerPx\r\n\r\n            let totalProfit = 0\r\n\r\n            //get positions from store\r\n            PostionStore.getData().forEach((mod) => {\r\n                totalProfit += mod.getProfit(mousePointX)\r\n            })\r\n\r\n            //cursor line\r\n            CanvasBuilder.ctx.beginPath()\r\n            CanvasBuilder.ctx.strokeStyle = \"green\"\r\n            CanvasBuilder.ctx.lineWidth = 1\r\n            CanvasBuilder.ctx.moveTo(x, 0)\r\n            CanvasBuilder.ctx.lineTo(x, CanvasBuilder.canvas.height)\r\n            CanvasBuilder.ctx.stroke()\r\n\r\n            CanvasBuilder.ctx.fillStyle = \"#000\"\r\n            CanvasBuilder.ctx.font = \"10px Arial\"\r\n\r\n            let floatText = \"price: \" + mousePointX.toString()\r\n            // floatText+=\"\\nprofit: \" + (CanvasBuilder.canvas.height/2-y)*CanvasBuilder.profitPerPx\r\n            let floatText2 = \"profit: \" + totalProfit / CanvasBuilder.profitPerPx\r\n            if (CanvasBuilder.ctx.measureText(floatText).width > CanvasBuilder.canvas.width - x - 10) {\r\n                CanvasBuilder.ctx.textAlign = \"right\"\r\n                CanvasBuilder.ctx.fillText(floatText, x - 10, y + 5);\r\n                CanvasBuilder.ctx.fillText(floatText2, x - 10, y + 15);\r\n            } else {\r\n\r\n                CanvasBuilder.ctx.textAlign = \"left\"\r\n                CanvasBuilder.ctx.fillText(floatText, x + 20, y + 5)\r\n                CanvasBuilder.ctx.fillText(floatText2, x + 20, y + 15);\r\n            }\r\n\r\n        })\r\n\r\n        CanvasBuilder.canvas.addEventListener('mouseout', (e) => {\r\n\r\n            CanvasBuilder.clear()\r\n            CanvasBuilder.draw()\r\n\r\n        })\r\n\r\n    }\r\n\r\n    static draw() {\r\n\r\n        CanvasBuilder.clear()\r\n\r\n        CanvasBuilder.settlePerPx = CanvasBuilder.settle_range / CanvasBuilder.canvas.width\r\n        CanvasBuilder.profitPerPx = CanvasBuilder.profit_range / CanvasBuilder.canvas.height\r\n\r\n        //baseline\r\n        CanvasBuilder.ctx.beginPath()\r\n        CanvasBuilder.ctx.strokeStyle = \"black\";\r\n        CanvasBuilder.ctx.moveTo(0, CanvasBuilder.canvas.height / 2)\r\n        CanvasBuilder.ctx.lineTo(CanvasBuilder.canvas.width, CanvasBuilder.canvas.height / 2)\r\n        CanvasBuilder.ctx.stroke()\r\n\r\n        PostionStore.getData().forEach((mod) => {\r\n\r\n\r\n            let settle_origin\r\n\r\n            //TXO or TX\r\n            if (mod.contract === Contract.TXO)\r\n                settle_origin = mod.strike\r\n            else\r\n                settle_origin = Number(Number(mod.price / 50).toFixed(0)) * 50\r\n\r\n            let x_0 = CanvasBuilder.convertSettleToX(settle_origin)\r\n\r\n            CanvasBuilder.max_settle = settle_origin + CanvasBuilder.settle_range / 2\r\n            CanvasBuilder.min_settle = settle_origin - CanvasBuilder.settle_range / 2\r\n\r\n            if (mod.contract === Contract.TXO) {\r\n                //base line\r\n                CanvasBuilder.ctx.beginPath()\r\n                CanvasBuilder.ctx.strokeStyle = \"red\"\r\n                CanvasBuilder.ctx.moveTo(x_0, 0)\r\n                CanvasBuilder.ctx.lineTo(x_0, CanvasBuilder.canvas.height);\r\n                CanvasBuilder.ctx.stroke()\r\n            }\r\n\r\n\r\n            //x - axis\r\n            CanvasBuilder.ctx.fillStyle = \"Teal \"\r\n            CanvasBuilder.ctx.font = \"8px Arial\"\r\n            CanvasBuilder.ctx.textAlign = \"center\"\r\n            CanvasBuilder.ctx.strokeStyle = \"black\";\r\n\r\n            for (let i = CanvasBuilder.min_settle; i <= CanvasBuilder.max_settle; i += 50) {\r\n\r\n                //scale\r\n                CanvasBuilder.ctx.beginPath()\r\n                CanvasBuilder.ctx.moveTo(this.convertSettleToX(i), CanvasBuilder.canvas.height / 2 * CanvasBuilder.profitPerPx - 5)\r\n                CanvasBuilder.ctx.lineTo(this.convertSettleToX(i), CanvasBuilder.canvas.height / 2 * CanvasBuilder.profitPerPx + 1)\r\n                CanvasBuilder.ctx.stroke()\r\n                \r\n                //settle text\r\n                CanvasBuilder.ctx.fillText(i.toString(), this.convertSettleToX(i), CanvasBuilder.canvas.height / 2 * CanvasBuilder.profitPerPx + 10)\r\n\r\n            }\r\n\r\n            //----draw diagram----\r\n            this.drawPosition(mod)\r\n\r\n            // if (mod.contract === Contract.TXO) {\r\n\r\n            // }\r\n\r\n\r\n\r\n        })\r\n\r\n    }\r\n\r\n    static convertSettleToX(settle: number) {\r\n        return (settle - CanvasBuilder.min_settle) / this.settlePerPx\r\n    }\r\n\r\n    static convertProfitToY(profit: number) {\r\n        return (CanvasBuilder.profit_range / 2 - profit) / this.profitPerPx\r\n    }\r\n\r\n    static clear() {\r\n        // ctx.clearRect(0, 0, canvas.width, canvas.height)\r\n        CanvasBuilder.ctx.fillStyle = \"#FFF\";\r\n        CanvasBuilder.ctx.fillRect(0, 0, CanvasBuilder.canvas.width, CanvasBuilder.canvas.height)\r\n    }\r\n\r\n    static drawPosition(mod: PositionModel) {\r\n\r\n        CanvasBuilder.ctx.strokeStyle = \"blue\"\r\n        CanvasBuilder.ctx.beginPath()\r\n\r\n        mod.getInflections(this.max_settle, this.profit_range / 2, this.min_settle, -this.profit_range / 2).forEach((\r\n            coor, idx) => {\r\n\r\n            let x = this.convertSettleToX(coor.x)\r\n            let y = this.convertProfitToY(coor.y)\r\n\r\n            // console.log('s:p '+coor.x+' : '+coor.y)\r\n            // console.log('x:y '+x+' : '+y)\r\n\r\n            if (idx === 0)\r\n                CanvasBuilder.ctx.moveTo(x, y)\r\n            else\r\n                CanvasBuilder.ctx.lineTo(x, y)\r\n\r\n        })\r\n\r\n        CanvasBuilder.ctx.stroke()\r\n    }\r\n}\r\n\r\nexport {}","import $ from 'jquery';\r\nimport {Coordinate} from './canvas'\r\nimport {PostionStore} from './position_store'\r\nimport {Utils} from './util'\r\n\r\nexport enum LS { LONG = \"Long\", SHORT = \"Short\" }\r\nexport enum CP { CALL = \"Call\", PUT = \"Put\" }\r\nexport enum Contract { TX = 'TX', TXO = 'TXO' }\r\n\r\n\r\nexport class PositionModel {\r\n\r\n  enabled: boolean\r\n  \r\n  contract: Contract\r\n  contractWeek: string\r\n  ls: LS\r\n  strike: number\r\n  cp: CP\r\n  amount: number\r\n  price: number\r\n  row = $(\"<tr>\")\r\n\r\n  td_act: JQuery<HTMLElement>\r\n  td_cp: JQuery<HTMLElement>\r\n  td_con: JQuery<HTMLElement>\r\n  td_strike: JQuery<HTMLElement>\r\n  td_amount: JQuery<HTMLElement>\r\n  td_price: JQuery<HTMLElement>\r\n\r\n  constructor() { }\r\n\r\n  static getTXInstance(\r\n    act: LS,\r\n    amount: number,\r\n    price: number) {\r\n\r\n    let init = new PositionModel();\r\n\r\n\r\n    init.amount = amount;\r\n    init.contract = Contract.TX;\r\n    init.ls = act;\r\n    init.price = price;\r\n\r\n    return init;\r\n  }\r\n\r\n  static getTXOInstance(act: LS,\r\n    cp: CP,\r\n    contract: Contract,\r\n    strike: number,\r\n    amount: number,\r\n    price: number) {\r\n\r\n    let init = new PositionModel();\r\n\r\n    init.amount = amount;\r\n    init.contract = Contract.TXO;\r\n    init.ls = act;\r\n    init.strike = strike;\r\n    init.cp = cp;\r\n    init.price = price;\r\n\r\n    return init;\r\n  }\r\n\r\n  //get value object\r\n  valChange() {\r\n\r\n    // console.log(this)\r\n    // CanvasBuilder.draw()\r\n\r\n    if(this.contract !== Contract.TXO){\r\n\r\n      this.td_cp.children().prop('disabled',true)\r\n      this.td_strike.children().prop('disabled',true)\r\n\r\n    }else{\r\n\r\n      this.td_cp.children().prop('disabled',false)\r\n      this.td_strike.children().prop('disabled',false)\r\n    }\r\n\r\n    PostionStore.plotPosition()\r\n\r\n  }\r\n\r\n  //add position row\r\n  addRow() {\r\n    this.row.click(function () {\r\n      $(this).addClass(\"selected\").siblings().removeClass(\"selected\");\r\n    });\r\n\r\n    // this.setCkx()\r\n    this.setDelBtn()\r\n    this.setContract()\r\n    this.setActionCbx()\r\n    this.setCPCbx()\r\n    this.setStrikePrice()\r\n    this.setAmount()\r\n    this.setPrice()\r\n\r\n    Utils.getPositionTable().append(this.row)\r\n  }\r\n\r\n  // setCkx() {\r\n\r\n  //   let td = $('<td>')\r\n  //   let check = $('<input>')\r\n\r\n  //   check.attr('type', 'checkbox')\r\n  //   check.attr('checked', 'true')\r\n\r\n  //   check.change(() => {\r\n  //     this.enabled = check.prop('checked')\r\n  //     console.log('chk chg ' + this.enabled)\r\n\r\n  //     this.valChange()\r\n  //   })\r\n\r\n  //   td.append(check);\r\n  //   this.row.append(td);\r\n  // }\r\n\r\n  setDelBtn() {\r\n\r\n    console.log('add del')\r\n\r\n    let td = $('<td>')\r\n    let btn = $('<button>')\r\n\r\n    btn.addClass('btn btn-default btn-sm')\r\n\r\n    let icon = $('<span>').addClass('glyphicon glyphicon-remove')\r\n    icon.css('color','red')\r\n    btn.append(icon)\r\n\r\n    btn.click(() => {\r\n      \r\n      PostionStore.removePosition(this)\r\n      this.row.remove()\r\n      PostionStore.plotPosition()\r\n    })\r\n\r\n    td.append(btn);\r\n    this.row.append(td);\r\n  }\r\n\r\n  setActionCbx() {\r\n\r\n    let td = $('<td>')\r\n    let lsCbx = $('<select>')\r\n    let long = document.createElement('option');\r\n\r\n    long.text = LS.LONG\r\n\r\n    let short = document.createElement('option');\r\n    short.text = LS.SHORT\r\n    lsCbx.append(long);\r\n    lsCbx.append(short);\r\n\r\n    lsCbx.change(() => {\r\n      if ($(\"option:selected\", lsCbx).val() === LS.LONG)\r\n        this.ls = LS.LONG\r\n      else\r\n        this.ls = LS.SHORT\r\n\r\n      console.log('chk chg ' + this.ls)\r\n      this.valChange()\r\n    })\r\n\r\n    if (this.ls == LS.LONG)\r\n      long.selected = true;\r\n    else\r\n      short.selected = true;\r\n\r\n    td.append(lsCbx);\r\n\r\n    this.row.append(td);\r\n    this.td_act = td\r\n  }\r\n\r\n  setContract() {\r\n\r\n    let td = $('<td>')\r\n\r\n    let conCbx = $('<select>')\r\n    let txo = document.createElement('option');\r\n    txo.text = Contract.TXO\r\n\r\n    let tx = document.createElement('option');\r\n    tx.text = Contract.TX\r\n    conCbx.append(txo);\r\n    conCbx.append(tx);\r\n\r\n    conCbx.change(() => {\r\n\r\n      if ($(\"option:selected\", conCbx).val() === Contract.TXO)\r\n        this.contract = Contract.TXO\r\n      else\r\n        this.contract = Contract.TX\r\n\r\n      console.log('cp chg ' + this.contract)\r\n      this.valChange()\r\n    })\r\n\r\n    if (this.contract == Contract.TXO)\r\n      txo.selected = true\r\n    else\r\n      tx.selected = true\r\n\r\n    td.append(conCbx)\r\n \r\n    this.row.append(td)\r\n    this.td_con = td\r\n  }\r\n\r\n  \r\n  setCPCbx() {\r\n\r\n    let td = $('<td>');\r\n    let lsCbx = $('<select>')\r\n\r\n    let c = document.createElement('option');\r\n    c.text = CP.CALL\r\n\r\n    let p = document.createElement('option');\r\n    p.text = CP.PUT\r\n    lsCbx.append(c);\r\n    lsCbx.append(p);\r\n\r\n    lsCbx.change(() => {\r\n      if ($(\"option:selected\", lsCbx).val() === CP.CALL)\r\n        this.cp = CP.CALL\r\n      else\r\n        this.cp = CP.PUT\r\n      console.log('cp chg ' + this.cp)\r\n      this.valChange()\r\n    })\r\n\r\n    if (this.cp == CP.CALL)\r\n      c.selected = true\r\n    else\r\n      p.selected = true\r\n\r\n    td.append(lsCbx)\r\n\r\n    this.row.append(td)\r\n    this.td_cp = td\r\n\r\n   \r\n  }\r\n\r\n  setStrikePrice() {\r\n\r\n    let td = $('<td>')\r\n    let input = $('<input>')\r\n    input.attr('type', 'number')\r\n    input.attr('step', 50)\r\n    input.val(this.strike)\r\n\r\n    input.change(() => {\r\n      this.strike = Number(input.val())\r\n      console.log('strike chg ' + this.strike)\r\n      this.valChange()\r\n    })\r\n\r\n\r\n\r\n    td.append(input)\r\n    this.row.append(td)\r\n    this.td_strike = td\r\n\r\n    \r\n  }\r\n\r\n  amountField:JQuery<HTMLElement>\r\n\r\n  setAmount() {\r\n\r\n    let td = $('<td>')\r\n\r\n    this.amountField = $('<input>')\r\n    this.amountField.attr('type', 'number')\r\n    this.amountField.val(this.amount)\r\n\r\n    this.amountField.change(() => {\r\n      this.amount = Number(this.amountField.val())\r\n      console.log('input chg ' + this.amount)\r\n      this.valChange()\r\n    })\r\n\r\n    td.append(this.amountField)\r\n    this.row.append(td)\r\n    this.td_amount = td\r\n  }\r\n\r\n  addAmount(i:number){\r\n    this.amount += i\r\n    this.amountField.val(this.amount)\r\n    this.valChange()\r\n  }\r\n\r\n  setPrice() {\r\n\r\n    let td = $('<td>')\r\n    let input = $('<input>')\r\n    input.attr('type', 'number')\r\n    input.attr('step', 0.5)\r\n    input.val(this.price)\r\n\r\n    input.change(() => {\r\n      this.price = Number(input.val())\r\n      console.log('price chg ' + this.price)\r\n      this.valChange()\r\n    })\r\n\r\n    td.append(input)\r\n    this.row.append(td)\r\n    this.td_price = td\r\n  }\r\n\r\n\r\n  getProfit(settle: number) {\r\n\r\n    // console.log('getProfit')\r\n\r\n    let ls = (this.ls === LS.LONG) ? -1 : 1\r\n    let profit\r\n\r\n    if (this.contract === Contract.TX) {\r\n\r\n      profit = this.price - settle * ls\r\n\r\n    } else if (this.contract === Contract.TXO) {\r\n\r\n      let cp = (this.cp === CP.CALL) ? 1 : -1\r\n\r\n      profit = ls * this.price\r\n\r\n      let isInTheMoney: boolean\r\n      if (cp === 1)\r\n        isInTheMoney = settle > this.strike\r\n      else\r\n        isInTheMoney = settle < this.strike\r\n\r\n      if (isInTheMoney)\r\n        profit -= ls * cp * (settle - this.strike)\r\n\r\n    }\r\n\r\n    return profit * this.amount\r\n  }\r\n\r\n  getSettle(profit: number) {\r\n\r\n    // console.log('getSettle')\r\n\r\n    let ls = (this.ls === LS.LONG) ? -1 : 1\r\n    let settle\r\n\r\n    if (this.contract === Contract.TX) {\r\n\r\n      settle = (profit / this.amount - this.price) / ls\r\n    } else if (this.contract === Contract.TXO) {\r\n      let cp = (this.cp === CP.CALL) ? 1 : -1\r\n      \r\n\r\n      let overTick = (profit / this.amount - ls * this.price) * cp\r\n\r\n      settle = this.strike + overTick * cp\r\n\r\n    }\r\n\r\n    return settle\r\n\r\n  }\r\n\r\n  getInflections(maxX: number, maxY: number, minX: number, minY: number) {\r\n\r\n    let re: Array<Coordinate> = []\r\n\r\n    //push minX point\r\n    let fMin = this.getProfit(minX)\r\n    if (fMin < minY) {\r\n      let x = this.getSettle(minY)\r\n      re.push(new Coordinate(x, minY))\r\n    } else {\r\n      re.push(new Coordinate(minX, fMin))\r\n    }\r\n\r\n    //push strike point\r\n    let fStrike = this.getProfit(this.strike)\r\n    let x = this.strike\r\n    re.push(new Coordinate(x, fStrike))\r\n\r\n    //push maxX point\r\n    let fMax = this.getProfit(maxX)\r\n    if (fMax > maxY) {\r\n      let x = this.getSettle(maxY)\r\n      re.push(new Coordinate(x, maxY))\r\n    } else {\r\n      re.push(new Coordinate(maxX, fMax))\r\n    }\r\n\r\n    return re\r\n  }\r\n\r\n  equals(o:PositionModel){\r\n\r\n    console.log('position equal')\r\n\r\n    return this.row === o.row\r\n  }\r\n}\r\n","import React from 'react';\r\nimport $ from 'jquery';\r\nimport { LS, PositionModel, CP, Contract } from '../model'\r\nimport { PostionStore } from '../position_store'\r\nimport Button from './Button';\r\nimport { Utils } from '../util'\r\nimport GlobalVar from '../Global'\r\nimport { Container, Row, Col } from 'react-grid-system';\r\n\r\n\r\nexport default class ContractGrid extends React.Component<Props, { items: Array<any> }> {\r\n\r\n\r\n  constructor(props: any) {\r\n\r\n    super(props);\r\n    this.state = {\r\n      items: [<Row><Col>Buy</Col><Col>Sell</Col><Col>Strike</Col><Col>Buy</Col><Col>Sell</Col></Row>]\r\n    }\r\n    props.children = [<Row><Col>Buy</Col><Col>Sell</Col><Col>Strike</Col><Col>Buy</Col><Col>Sell</Col></Row>]\r\n\r\n  }\r\n\r\n  addRow(row: React.ReactChild) {\r\n    this.setState({\r\n      items: [...this.state.items, row]\r\n    })\r\n  }\r\n\r\n  clear(){\r\n    this.setState({\r\n      items: [<Row><Col>Buy</Col><Col>Sell</Col><Col>Strike</Col><Col>Buy</Col><Col>Sell</Col></Row>]\r\n    })\r\n  }\r\n\r\n  render() {\r\n    return (<Container>\r\n      {React.Children.map(this.state.items, child => {\r\n        return child\r\n      })}\r\n    </Container>);\r\n  }\r\n}\r\n\r\n\r\ninterface Props {\r\n  // lcBtn: any;\r\n  // scBtn: any;\r\n  // strike:any;\r\n  // lpBtn: any;\r\n  // spBtn: any;\r\n  children?: React.ReactChild[];\r\n  ref?: any\r\n}\r\n\r\ninterface State {\r\n  items: Array<any>\r\n  ref?: Date\r\n}\r\n","import React from 'react';\r\n\r\n\r\nexport default class ContractWeekCombo extends React.Component<Props, { value?: string, items: Array<any> }> {\r\n  constructor(props: any) {\r\n\r\n    super(props);\r\n    this.state = {\r\n      items: []\r\n    }\r\n\r\n    // this.handleChange = this.handleChange.bind(this);\r\n    // props.children = [<Row><Col>Buy</Col><Col>Sell</Col><Col>Strike</Col><Col>Buy</Col><Col>Sell</Col></Row>]\r\n\r\n  }\r\n\r\n  addContractCode(weekCode: string) {\r\n    this.setState({\r\n      items: [...this.state.items, <option value={weekCode}>{weekCode}</option>]\r\n    })\r\n  }\r\n\r\n  setContractCode(weekCode: string) {\r\n    this.setState({\r\n      items: [...this.state.items], value:weekCode\r\n    })\r\n    // this.props.onChangeImpl(weekCode)\r\n  }\r\n\r\n  clear() {\r\n    this.setState({\r\n      items: []\r\n    })\r\n  }\r\n\r\n  handleChange(event: React.ChangeEvent<HTMLSelectElement>) {\r\n    console.log('contract cmb:' + event.target.value)\r\n    this.setState({ items: this.state.items, value: event.target.value });\r\n    this.props.onChangeImpl(event.target.value)\r\n  }\r\n\r\n  render() {\r\n    return (<select value={this.state.value} onChange={e=>this.handleChange.apply(this,[e])}>\r\n      {React.Children.map(this.state.items, child => {\r\n        return child\r\n      })}\r\n    </select>);\r\n  }\r\n\r\n}\r\n\r\ninterface Props {\r\n  onChangeImpl: Function;\r\n  // onChange:Function\r\n  children?: React.ReactChild[];\r\n  ref?: any\r\n}","import React from \"react\";\r\nimport Modal from 'react-modal';\r\nimport { Utils } from '../util'\r\n\r\nexport default class Popup extends React.Component<{\r\n  isOpen?: boolean\r\n  ref?: any\r\n\r\n}, { isOpen?: boolean, json?: string }> {\r\n\r\n  constructor(props: any) {\r\n\r\n    super(props);\r\n    this.state = {\r\n      isOpen: false\r\n      // items: [<Row><Col>Buy</Col><Col>Sell</Col><Col>Strike</Col><Col>Buy</Col><Col>Sell</Col></Row>]\r\n    }\r\n\r\n    this.handleOpenModal = this.handleOpenModal.bind(this);\r\n    this.handleCloseModal = this.handleCloseModal.bind(this);\r\n    this.handleChange = this.handleChange.bind(this);\r\n  }\r\n\r\n  handleOpenModal = () => {\r\n    this.setState({ isOpen: true });\r\n  };\r\n\r\n  handleCloseModal = () => {\r\n    this.setState({ isOpen: false });\r\n  };\r\n\r\n  loadJson = () => {\r\n    console.log('loadjson: '+this.state.json)\r\n    let obj = JSON.parse(this.state.json)\r\n    obj.forEach((element: any) => {\r\n      console.log('el')\r\n      console.log(element)\r\n      let pos = Utils.parsePositionForRaw(element)\r\n      Utils.addPosition(pos)\r\n    });\r\n    console.log('close pop')\r\n    this.setState({ isOpen: false });\r\n  }\r\n\r\n  handleChange(event: React.ChangeEvent<HTMLTextAreaElement>) {\r\n     this.setState({ isOpen: this.state.isOpen, json: event.target.value }); }\r\n\r\n  render() {\r\n    const txtStyle = { 'min-height': '500px', width: '100%' }\r\n\r\n    return (<Modal isOpen={this.state.isOpen} >\r\n      <textarea style={txtStyle} defaultValue=\"json\" value={this.state.json} onChange={this.handleChange} />\r\n      <button onClick={this.loadJson}>Load</button>\r\n      <button onClick={this.handleCloseModal}>\r\n        Close\r\n      </button>\r\n    </Modal>);\r\n  }\r\n}","import React from 'react';\r\nimport $ from 'jquery';\r\nimport { LS, PositionModel, CP, Contract } from '../model'\r\nimport { PostionStore } from '../position_store'\r\nimport Button from './Button';\r\nimport { Utils } from '../util'\r\nimport GlobalVar from '../Global'\r\nimport ContractGrid from './ContractGrid'\r\nimport { Container, Row, Col } from 'react-grid-system';\r\nimport ContractWeekCombo from './ContractWeekCombo'\r\nimport Popup from './Popup';\r\n\r\nclass HomePage extends React.Component {\r\n\r\n  contractSelector = React.createRef<ContractGrid>()\r\n  contractWeekCombo = React.createRef<ContractWeekCombo>()\r\n  jsonPopup = React.createRef<Popup>()\r\n\r\n  addContractRows() {\r\n    this.contractSelector.current.clear()\r\n\r\n    for (let i = 0; i < GlobalVar.txoData.strikes.length; i++) {\r\n      let c = GlobalVar.txoData.callContracts[i]\r\n      let p = GlobalVar.txoData.putContracts[i]\r\n      let s = GlobalVar.txoData.strikes[i]\r\n\r\n      // if (Math.abs(s - GlobalVar.txoData.spot) > 600)\r\n      //   continue\r\n\r\n      let lcBtn = Utils.createPosiBtn(c, LS.LONG)\r\n      let scBtn = Utils.createPosiBtn(c, LS.SHORT)\r\n      let lpBtn = Utils.createPosiBtn(p, LS.LONG)\r\n      let spBtn = Utils.createPosiBtn(p, LS.SHORT)\r\n\r\n\r\n      // let tr = '<td>' + lcBtn + '</td><td>' + scBtn + '</td><th>' + s + '</td><td>' + lpBtn + '</td><td>' + spBtn + '</td>'\r\n\r\n      let rowStyle = {}\r\n      if (Math.abs(s - GlobalVar.txoData.spot) <= 50) {\r\n        rowStyle = { 'background-color': 'skyblue' }\r\n      }\r\n\r\n      let row = <Row style={rowStyle}>{lcBtn}{scBtn}<Col>{s}</Col>{lpBtn}{spBtn}</Row>\r\n      this.contractSelector.current.addRow(row)\r\n\r\n      // selector.append(tr)\r\n    }\r\n  }\r\n\r\n  loadTxoData(home: any, contractWeek?: string) {\r\n    // let home = this;\r\n    // load raw data\r\n    $.get(window.location.href.match(/^.*\\//)[0] + \"servlet/getTxoData\", { contractWeek: contractWeek }, function (data) {\r\n      GlobalVar.txoData = data.data;\r\n      console.log('load data contractWeek:' + contractWeek + ' target week: ' + GlobalVar.txoData.targetContractCode)\r\n      console.log(GlobalVar.txoData)\r\n\r\n\r\n      // set spot\r\n      console.log('spot:' + GlobalVar.txoData.spot)\r\n      $('#spot').val(GlobalVar.txoData.spot)\r\n\r\n\r\n      // set contract weeks\r\n      home.contractWeekCombo.current.clear()\r\n\r\n      GlobalVar.txoData.contractCodes.forEach((code: string) => {\r\n        home.contractWeekCombo.current.addContractCode(code)\r\n      });\r\n\r\n      home.contractWeekCombo.current.setContractCode(GlobalVar.txoData.targetContractCode)\r\n\r\n      // init selector\r\n      home.addContractRows()\r\n\r\n      PostionStore.plotPosition()\r\n    });\r\n  }\r\n\r\n  componentDidMount() {\r\n    console.log('onload');\r\n\r\n    this.loadTxoData(this)\r\n\r\n    // let srcPos: Array<any> = JSON.parse(POS)\r\n    // srcPos.forEach(element => {\r\n    //   let pos = Utils.parsePositionForRaw(element)\r\n    //   Utils.addPosition(pos)\r\n    // });\r\n\r\n\r\n    $('#addBtn').click(() => {\r\n      let m_2 = PositionModel.getTXOInstance(LS.LONG, CP.CALL, Contract.TXO, 16000, 1, 64.5)\r\n\r\n      Utils.addPosition(m_2)\r\n    })\r\n\r\n    $('#clearBtn').click(() => {\r\n      PostionStore.removeAllPosition()\r\n\r\n    })\r\n\r\n    $('#toJsonBtn').click(() => {\r\n      let json = PostionStore.getDataJson()\r\n      window.alert(json)\r\n    })\r\n\r\n    $('#loadJsonBtn').click(() => {\r\n        this.jsonPopup.current.handleOpenModal()\r\n    })\r\n\r\n    $('#spot').change(() => {\r\n      PostionStore.plotPosition()\r\n    })\r\n\r\n    // CanvasBuilder.init()\r\n  }\r\n\r\n  render() {\r\n    const bodyStyle = { padding: \"20px\" }\r\n    const plotStyle = { display: 'inline-block', 'vertical-align': 'top' }\r\n    const selectorStyle = {\r\n      display: 'inline-block', 'max-height': '400px', overflow: 'auto',\r\n      width: '500px', padding: '5px', border: '1px solid black'\r\n    }\r\n    let home = this\r\n\r\n    return (\r\n      <div style={bodyStyle}>\r\n        <Popup ref={this.jsonPopup}>popup</Popup>\r\n        <div>\r\n          <div>\r\n            <label>Spot</label>\r\n            <input id=\"spot\" type=\"number\" />\r\n          </div>\r\n\r\n          <div>\r\n            <label>Default Cost(tick/lot)</label>\r\n            <input id=\"defaultCost\" type=\"number\" min=\"0\" defaultValue=\"2\" />\r\n          </div>\r\n          <div id=\"fplot\" style={plotStyle}></div>\r\n\r\n          <div style={selectorStyle}>\r\n            <div>\r\n              <div>\r\n                <label>Contract Week</label>\r\n                <ContractWeekCombo ref={this.contractWeekCombo} onChangeImpl={(v: string) => home.loadTxoData.apply(null, [home, v])}></ContractWeekCombo>\r\n              </div>\r\n            </div>\r\n            <ContractGrid ref={this.contractSelector}></ContractGrid>\r\n          </div>\r\n        </div>\r\n        <br />\r\n        <div>\r\n          <button id=\"addBtn\">Add</button>\r\n          <button id=\"clearBtn\">Clear</button>\r\n          <button id=\"toJsonBtn\">To JSON</button>\r\n          <button id=\"loadJsonBtn\">Load JSON</button>\r\n        </div>\r\n        <div>\r\n          <table id=\"positionTable\">\r\n            <tr>\r\n              <th></th>\r\n              <th>標的</th>\r\n              <th>買賣</th>\r\n              <th>C/P</th>\r\n              <th>履約價</th>\r\n              <th>數量</th>\r\n              <th>價格</th>\r\n            </tr>\r\n          </table>\r\n        </div>\r\n\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default HomePage","import React from 'react';\r\n\r\n\r\nimport HomePage from './component/HomePage';\r\nimport './App.css';\r\nimport {LS} from './model'\r\n\r\ndeclare function functionPlot(arg: any): any;\r\n\r\n\r\n/*\r\nwindow.onload = function (){\r\n  \r\n  console.log('onload');\r\n  // load raw data\r\n  $.get( \"servlet/getTxoData\", function( data) {\r\n     txoData = data.data;\r\n    console.log('load data:' +txoData)\r\n\r\n     // set spot\r\n  $('#spot').val(txoData.spot)\r\n\r\n  // init selector\r\n  loadContracts()\r\n\r\n  \r\n  PostionStore.plotPosition()\r\n });\r\n\r\n \r\n\r\n  // let srcPos: Array<any> = JSON.parse(POS)\r\n  // srcPos.forEach(element => {\r\n  //   let pos = Utils.parsePositionForRaw(element)\r\n  //   Utils.addPosition(pos)\r\n  // });\r\n\r\n\r\n  $('#addBtn').click(() => {\r\n    let m_2 = PositionModel.getTXOInstance(LS.LONG, CP.CALL, Contract.TXO, 16000, 1, 64.5)\r\n\r\n    Utils.addPosition(m_2)\r\n  })\r\n\r\n  $('#clearBtn').click(() => {\r\n    PostionStore.removeAllPosition()\r\n   \r\n  })\r\n\r\n  $('#spot').change(() => {\r\n    PostionStore.plotPosition()\r\n  })\r\n\r\n\r\n\r\n  // CanvasBuilder.init()\r\n\r\n}\r\n*/\r\n\r\n/*\r\nfunction App() {\r\n  return (\r\n    <>\r\n      <h1>Colorful Custom Button Components</h1>\r\n      \r\n<div>\r\n    <div>\r\n        <button id=\"refreshBtn\">Refresh</button>\r\n    </div>\r\n    <div>\r\n        <div id=\"fplot\"></div>\r\n        <div>\r\n            <table id=\"contractSelector\"> </table>\r\n        </div>\r\n    </div>\r\n    <br/>\r\n    <div>\r\n        <label>Spot</label>\r\n        <input id=\"spot\" type=\"number\"/>\r\n        <button id=\"addBtn\">Add</button>\r\n        <button id=\"clearBtn\">Clear</button>\r\n    </div>\r\n    <div>\r\n        <table id=\"positionTable\">\r\n            <tr>\r\n                <th></th>\r\n                <th>標的</th>\r\n                <th>買賣</th>\r\n                <th>C/P</th>\r\n                <th>履約價</th>\r\n                <th>數量</th>\r\n                <th>價格</th>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n    \r\n</div>\r\n    </>\r\n  );\r\n}\r\n*/\r\n\r\n// function App() {\r\n//   return (\r\n//     <>\r\n//       <h1>Colorful Custom Button Components</h1>\r\n//       <Button \r\n//         border=\"none\"\r\n//         color=\"pink\"\r\n//         height = \"200px\"\r\n//         onClick={() => alert(\"You clicked on the pink circle!\")}\r\n//         radius = \"50%\"\r\n//         width = \"200px\"\r\n//         children = \"I'm a pink circle!\"\r\n//       />\r\n//       <br></br>\r\n//     </>\r\n//   );\r\n// }\r\nfunction App() {\r\n  return (\r\n    <HomePage />\r\n  );\r\n}\r\n\r\n\r\nexport default App;\r\n\r\n\r\n\r\n","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}